webpackJsonp([2],{0:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),c=r(i),l=n(17),p=n(27),f=n(233),d=r(f),h=n(232),y=r(h);n(239);var m=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){return c.default.createElement(p.Provider,{store:y.default},c.default.createElement(d.default,null))}}]),t}(c.default.Component);(0,l.render)(c.default.createElement(m,null),document.getElementById("form-response"))},231:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments[1];return function(){switch(t.type){case"update_answer":var n=e.response.answers.findIndex(function(e){return e.code===t.answer.code}),r=(0,s.default)(e.response.answers[n],{$merge:t.answer});e=(0,s.default)(e,{response:{answers:{$splice:[[n,1,r]]}}});break;case"set_fetching":e=(0,s.default)(e,{status:{is_fetching:{$set:!0},success:{$set:!1},error:{$set:!1},message:{$set:""}}});break;case"get_form_success":var o=[],a={},u=function(e,t,n,r){o.push({code:e,question:t,answer:n}),a[e]={required:r}};t.form.contents.questions.forEach(function(e){"text"===e.type||"list"===e.type?u(e.code,e.question,"",e.required):"table"===e.type&&e.sub_questions.forEach(function(t){e.columns.length>1?e.columns.forEach(function(e){"check"!==e.type?u(t.value+e.code_suffix,t.text+" ("+e.header+")","",t.required):u(t.value+e.code_suffix,t.text+" ("+e.header+")","n",t.required)}):u(t.value,t.text,"",t.required)})}),e=(0,s.default)(e,{form:{$set:t.form},response:{answers:{$set:o}},validation:{$set:a},status:{is_fetching:{$set:!1},message:{$set:"Encuesta cargada."}}});break;case"update_validation":var i={};i[t.code]={required:t.required},e=(0,s.default)(e,{validation:{$merge:i}});break;case"get_form_error":e=(0,s.default)(e,{status:{is_fetching:{$set:!1},message:{$set:"Error al cargar encuesta."}}});break;case"post_response_success":e=(0,s.default)(e,{response:{id:{$set:t.id},answers:{$set:t.answers}},status:{is_fetching:{$set:!1},message:{$set:"Respuestas guardadas"}}});break;case"post_response_error":e=(0,s.default)(e,{status:{is_fetching:{$set:!1},message:{$set:"Error al guardar respuestas"}}});break;case"status_show_notification":e=(0,s.default)(e,{status:{message:{$set:t.message}}});break;case"status_dismiss_notification":e=(0,s.default)(e,{status:{message:{$set:""}}})}}(),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var a=n(33),s=r(a),u={form:{id:0,code:"",name:"",description:"",contents:{next_id:1,questions:[]}},response:{id:0,answers:[]},status:{is_fetching:!1,message:""}}},232:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(134),a=n(231),s=r(a),u=(0,o.createStore)(s.default,window.devToolsExtension&&window.devToolsExtension());t.default=u},233:function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),c=r(i),l=n(27),p=n(19),f=n(183),d=n(135),h=r(d),y=n(235),m=r(y),v=n(237),_=r(v),b=n(136),w=r(b),g=function(t){function n(){var t,r,s,u;o(this,n);for(var i=arguments.length,c=Array(i),l=0;l<i;l++)c[l]=arguments[l];return r=s=a(this,(t=n.__proto__||Object.getPrototypeOf(n)).call.apply(t,[this].concat(c))),s.postFormResponse=function(){if(!s.validateForm())return void s.props.dispatchShowNotifications("Error. Capture los campos obligatorios.");s.props.dispatchSetFetching();var t=0===s.props.response.id,n=t?"/api/responses/":"/api/responses/"+s.props.response.id+"/",r={id:s.props.response.id,form:s.props.form.id,answers:s.props.response.answers};e(n,{method:t?"POST":"PUT",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":w.default.getCookie("csrftoken")},body:JSON.stringify(r)}).then(function(e){return e.json()}).then(function(e){return s.props.dispatchPostSurveyResponseSuccess(e)}).catch(function(e){return s.props.dispatchPostSurveyResponseError()})},s.dismissNotificationHandler=function(){s.props.dispatchDismissNotifications()},s.updateTextHandler=function(e,t){s.props.dispatchUpdateAnswer({code:e,answer:t})},u=r,a(s,u)}return s(n,t),u(n,[{key:"getForm",value:function(){var t=this;this.props.dispatchSetFetching(),e("/api/forms/"+form_id+"/?format=json",{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){return t.props.dispatchGetSurveySuccess(e)}).catch(function(e){return t.props.dispatchGetSurveyError()})}},{key:"componentDidMount",value:function(){0!==form_id&&this.getForm()}},{key:"validateForm",value:function(){var e=this.props.validation;return!this.props.response.answers.some(function(t){var n=t.answer.trim();return t.code in e&&e[t.code].required&&(""===n||"0"===n)})}},{key:"render",value:function(){var e=this,t=this.props.form.contents.questions.map(function(t){if(t.conditional){var n=e.props.response.answers.filter(function(e){return e.code==t.condition.question_key})[0];if(n&&t.condition.question_value===n.answer)return}return"header"===t.type?c.default.createElement("div",{key:t.key,className:"element"},c.default.createElement("h3",null,t.header)):"text"===t.type?c.default.createElement(h.default,{key:t.key,code:t.code,label:t.question,helpText:t.help_text,required:t.required,updateText:e.updateTextHandler,showCode:!0}):"list"===t.type?c.default.createElement(m.default,{key:t.key,question:t}):"table"===t.type?c.default.createElement(_.default,{key:t.key,question:t}):void 0});return c.default.createElement("div",null,t,c.default.createElement("div",{className:"form-footer clearfix"},c.default.createElement(p.Button,{bsStyle:"primary",className:"pull-right",disabled:this.props.status.is_fetching,onClick:this.postFormResponse},"Enviar")),c.default.createElement(f.Notification,{isActive:this.props.status.message.length>0,message:this.props.status.message,onDismiss:this.dismissNotificationHandler}))}}]),n}(c.default.Component),E=function(e){return{form:e.form,response:e.response,validation:e.validation,status:e.status}},k=function(e){return{dispatchUpdateAnswer:function(t){e({type:"update_answer",answer:t})},dispatchGetSurveySuccess:function(t){e({type:"get_form_success",form:t})},dispatchGetSurveyError:function(){e({type:"get_form_error"})},dispatchPostSurveyResponseSuccess:function(t,n){e({type:"post_response_success",id:t,answers:n})},dispatchPostSurveyResponseError:function(){e({type:"post_response_error"})},dispatchSetFetching:function(){e({type:"set_fetching"})},dispatchShowNotifications:function(t){e({type:"status_show_notification",message:t})},dispatchDismissNotifications:function(){e({type:"status_dismiss_notification"})}}};g=(0,l.connect)(E,k)(g),t.default=g}).call(t,n(138))},234:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),l=r(c),p=n(19),f=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateValueHandler=function(e){var t=e.target.value.trim();"checkbox"===n.props.type&&(t=n.state.checked?"n":"y",n.setState({checked:!n.state.checked})),n.props.updateAnswer({code:n.props.code,answer:t})},n.state={checked:!1},n}return s(t,e),i(t,[{key:"render",value:function(){var e={};return"checkbox"===this.props.type&&(e.defaultChecked=this.state.checked),l.default.createElement(p.FormControl,u({className:"radio"===this.props.type||"checkbox"===this.props.type?"cell-input":"",type:this.props.type,name:this.props.group,value:this.props.value,onChange:this.updateValueHandler},e))}}]),t}(l.default.Component);t.default=f},235:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),l=r(c),p=n(27),f=n(19),d=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.updateAnswerHandler=function(e){n.props.dispatchUpdateAnswer(n.props.question.code,e.target.value),n.setState({valid:"0"!==e.target.value})},n.state={valid:!0},n}return s(t,e),i(t,[{key:"componentDidMount",value:function(){this.props.dispatchUpdateValidation(this.props.question.code,!0)}},{key:"componentWillUnmount",value:function(){this.props.dispatchUpdateAnswer(this.props.question.code,""),this.props.dispatchUpdateValidation(this.props.question.code,!1)}},{key:"render",value:function(){var e=this.props.question.choices.map(function(e){return l.default.createElement("option",{key:e.key,value:e.value},e.text)}),t="";this.props.question.help_text&&(t=l.default.createElement(f.HelpBlock,null,this.props.question.help_text));var n="";this.props.question.required&&(n=l.default.createElement("span",{className:"required"},"*"));var r={};return this.props.question.required&&!this.state.valid&&(r.validationState="error"),l.default.createElement("div",{className:"element"},l.default.createElement(f.FormGroup,u({controlId:"question"+this.props.question.code,className:"list-field"},r),l.default.createElement(f.ControlLabel,null,this.props.question.code+". "+this.props.question.question,n),t,l.default.createElement(f.FormControl,{componentClass:"select",onChange:this.updateAnswerHandler},l.default.createElement("option",{value:"0"},"Selecciona una opción ... "),e)))}}]),t}(l.default.Component),h=function(e){return{dispatchUpdateAnswer:function(t,n){e({type:"update_answer",answer:{code:t,answer:n}})},dispatchUpdateValidation:function(t,n){e({type:"update_validation",code:t,required:n})}}};d=(0,p.connect)(null,h)(d),t.default=d},236:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),c=r(i),l=n(19),p=function(e){function t(){var e,n,r,s;o(this,t);for(var u=arguments.length,i=Array(u),c=0;c<u;c++)i[c]=arguments[c];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.updateValueHandler=function(e){r.props.updateAnswer({code:r.props.code,answer:e.target.value})},s=n,a(r,s)}return s(t,e),u(t,[{key:"render",value:function(){var e=this.props.choices.map(function(e){return c.default.createElement("option",{key:e.key,value:e.value},e.text)});return c.default.createElement(l.FormControl,{componentClass:"select",onChange:this.updateValueHandler},c.default.createElement("option",{value:"0"},"Selecciona una opción ... "),e)}}]),t}(c.default.Component);t.default=p},237:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),c=r(i),l=n(27),p=n(19),f=n(234),d=r(f),h=n(236),y=r(h),m=function(e){function t(){var e,n,r,s;o(this,t);for(var u=arguments.length,i=Array(u),c=0;c<u;c++)i[c]=arguments[c];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.updateAnswerHandler=function(e){r.props.dispatchUpdateAnswer(e)},s=n,a(r,s)}return s(t,e),u(t,[{key:"render",value:function(){var e=this,t=c.default.createElement("tr",null,c.default.createElement("th",null),this.props.question.columns.map(function(e){var t=0;return"radio"!==e.type&&"list"!==e.type||(t=e.choices.length),c.default.createElement("th",{key:e.key,colSpan:t},e.header)})),n=this.props.question.columns.some(function(e){return"radio"===e.type}),r=c.default.createElement("tr",null,c.default.createElement("th",null),this.props.question.columns.map(function(e){return"radio"===e.type?e.choices.map(function(t){return c.default.createElement("th",{key:e.key+"."+t.key},t.text)}):c.default.createElement("th",{key:e.key})})),o=this.props.question.sub_questions.map(function(t){var n=e.props.question.columns.map(function(n){return"text"===n.type?c.default.createElement("td",{key:n.key},c.default.createElement(d.default,{type:"input",code:t.value+n.code_suffix,updateAnswer:e.updateAnswerHandler})):"list"===n.type?c.default.createElement("td",{key:n.key},c.default.createElement(y.default,{code:t.value+n.code_suffix,choices:n.choices,updateAnswer:e.updateAnswerHandler})):"radio"===n.type?n.choices.map(function(r){var o="radio"+e.props.question.key+"."+t.key+"."+n.key;return c.default.createElement("td",{key:n.key+"."+r.key},c.default.createElement(d.default,{type:"radio",code:t.value+n.code_suffix,group:o,value:r.value,updateAnswer:e.updateAnswerHandler}))}):"check"===n.type?c.default.createElement("td",{key:n.key},c.default.createElement(d.default,{type:"checkbox",code:t.value+n.code_suffix,updateAnswer:e.updateAnswerHandler})):void 0}),r=" ";return t.required&&(r=c.default.createElement("span",{className:"required"},"*")),c.default.createElement("tr",{key:t.key},c.default.createElement("td",{className:"sub-question"},t.value+". "+t.text,r),n)}),a="";return this.props.question.help_text&&(a=c.default.createElement(p.HelpBlock,null,this.props.question.help_text)),c.default.createElement("div",{className:"element"},c.default.createElement(p.FormGroup,null,c.default.createElement(p.ControlLabel,null,this.props.question.code+". "+this.props.question.question),a,c.default.createElement(p.Table,{striped:!0,hover:!0},c.default.createElement("thead",null,t,n?r:null),c.default.createElement("tbody",null,o))))}}]),t}(c.default.Component),v=function(e){return{dispatchUpdateAnswer:function(t){e({type:"update_answer",answer:t})}}};m=(0,l.connect)(null,v)(m),t.default=m},239:function(e,t){}});